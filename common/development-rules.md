## 開発環境

### 主要技術スタック

- **言語**: TypeScript/JavaScript (Node.js)
- **パッケージマネージャー**: pnpm, yarn, volta
- **データベース**: MySQL with Prisma, TiDB, AWS Aurora, Supabase
- **バックエンド**: NestJS, GraphQL
- **フロントエンド**: Next.js
- **テスト**: Vitest
- **コードスタイル**: ESLint, Prettier

### ツール・ユーティリティ

- **バージョン管理**: Git
- **コンテナ**: Docker
- **クラウド**: AWS, TiDB, GCP
- **CI/CD**: GitHub Actions, GitLab CI
- **IDE**: VS Code
- **ターミナル**: Zsh with custom dotfiles

## プロジェクト規約

### コードスタイル

- TypeScript で型安全性を確保
- DDD アーキテクチャパターンを採用
- 関数型プログラミングを優先（副作用のないコード）
- 命令型よりも宣言型のコードを好む
- 既存プロジェクトのパターンと規約に従う
- デコレーターを適切に使用（NestJS 等）
- カスタム例外による適切なエラーハンドリング

### ORM

- Prisma
  - 適切なリポジトリパターンの実装
  - 複雑なクエリには Prisma のクエリビルダーを使用
- TypeORM
  - エンティティとリポジトリの適切な分離
  - トランザクション管理の実装

### API 開発

- GraphQL スキーマファーストアプローチ
  - NestJS の場合はコードファースト
- 適切な入力値検証の実装
- DTO によるデータ転送
- セキュリティベストプラクティスの適用

### フロントエンド開発

- Next.js の App Router を活用
- Server Components と Client Components の適切な使い分け
- TypeScript での型安全なコンポーネント開発
- 関数型コンポーネントと Hooks の使用

## 開発方針

### 言語とコミュニケーション

- **AIへの指示**: 日本語で行う
- **AIからの返答**: 日本語で受け取る
- **コメント**: 日本語で記述（国際的な開発標準に従う）
- **テストケース**: 日本語で記述（国際的な開発標準に従う）
- **変数名・関数名**: 英語

### タスク管理

- 複雑なマルチステップタスクには TodoWrite ツールを使用
- 大きな機能を管理しやすいステップに分割
- 進捗を体系的に追跡
- 完了後すぐに todo を完了マークする

### コード品質

- 防御的セキュリティプラクティスに従う
- 機密データや秘密情報を決して公開しない
- 機密情報なしの適切なログ実装
- コードベースの確立されたパターンを使用

## 開発ワークフロー

### Git ワークフロー

- フィーチャーブランチで作業
- 従来のコミットメッセージを使用
- コードレビューのためのプルリクエスト作成
- クリーンなコミット履歴を維持

### テスト

- Vitest を使用したユニット・統合テスト
- ビジネスロジックのテストケース作成
- API エンドポイントの統合テスト実行
- フロントエンドコンポーネントのテスト
- クリティカルパスのテストカバレッジ確保
- 外部依存関係の適切なモックとスタブを使用

### ドキュメンテーション

- 重要な変更時に README.md を更新 (VitePress で docs/ディレクトリがある場合はそちらを更新)
- 適切なファイルで API の変更を文書化
- 複雑なロジックにインラインコメントを維持
- 簡潔で実用的なドキュメントを保持

## プロジェクト固有の注意事項

### 現在のプロジェクト (aim-at-CMS-api)

- NestJS ベースの GraphQL API
- MySQL データベースと Prisma
- マイクロサービスアーキテクチャパターン
- デコレーターの多用（@Retry, @Transactional）
- トランザクション管理とデータベース接続最適化に重点

### 共通パターン

- Controller → Service → Repository アーキテクチャ
- 複雑なビジネスロジックには UseCase パターン
- データ変換のための DTO ファクトリー
- カスタム例外による包括的なエラーハンドリング
- データベース操作のリトライメカニズム

## DDD（ドメイン駆動設計）原則

### アーキテクチャ

- エンティティとバリューオブジェクトの明確な分離
- ドメインサービスによるビジネスロジックの集約
- リポジトリパターンによるデータアクセスの抽象化
- アプリケーションサービスによるユースケースの実装

### 関数型プログラミング

- 副作用のない純粋関数を優先
- イミュータブルなデータ構造の使用
- 関数合成とパイプラインパターン
- 命令型ループよりも map, filter, reduce を使用

## パフォーマンス考慮事項

### データベース最適化

- オペレーションごとの単一データベース接続使用
- 適切なトランザクション境界の実装
- パフォーマンスのためのクエリ最適化
- コネクションプール使用量の監視

### フロントエンド最適化

- Next.js の SSR と SSG を適切に活用
- 画像最適化と Core Web Vitals の改善
- バンドルサイズの最適化
- 適切なキャッシュ戦略の実装

### コード最適化

- レスポンスでの出力トークンの最小化
- 効率的なアルゴリズムとデータ構造の使用
- メモリ使用量の監視と最適化

## セキュリティガイドライン

### データ保護

- 機密情報を決してログに記録しない
- 適切な入力値検証の実装
- SQL インジェクション防止のためのパラメータ化クエリ使用
- 適切な認証と認可の適用

### コードセキュリティ

- セキュアコーディング実践に従う
- 依存関係の定期的な更新
- セキュリティリンターとスキャナーの使用
- 情報漏洩のない適切なエラーハンドリング

---

*この設定は dotfiles で管理され、開発環境間で自動的に同期されます。*